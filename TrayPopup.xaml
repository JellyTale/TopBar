<Window x:Class="TopBar.TrayPopup"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="System Tray"
        Width="300" SizeToContent="Height"
        MaxHeight="500"
        WindowStartupLocation="Manual"
        WindowStyle="None" AllowsTransparency="True"
        Background="Transparent" ResizeMode="NoResize"
        ShowInTaskbar="False" Topmost="True"
        Deactivated="Window_Deactivated"
        MouseEnter="Window_MouseEnter"
        MouseLeave="Window_MouseLeave">

    <Border Background="#01000000" BorderBrush="{DynamicResource PopupAccent}"
            BorderThickness="1" CornerRadius="8" Padding="16,14">
        <StackPanel>
            <TextBlock Text="System Tray" Foreground="{DynamicResource PopupFgLabel}"
                       FontSize="11" Margin="0,0,0,10"/>

            <!-- Refresh button -->
            <Border Background="{DynamicResource PopupButtonBg}" CornerRadius="4"
                    Padding="8,3" Cursor="Hand" HorizontalAlignment="Left"
                    Margin="0,0,0,10"
                    MouseLeftButtonUp="Refresh_Click">
                <TextBlock Text="âŸ³ Refresh" Foreground="{DynamicResource PopupFgNormal}" FontSize="11"/>
            </Border>

            <!-- Tray icons grid -->
            <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="380">
                <ItemsControl x:Name="IconsPanel">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </ScrollViewer>

            <TextBlock x:Name="EmptyLabel" Text="No tray icons found"
                       Foreground="{DynamicResource PopupFgDim}" FontSize="11"
                       HorizontalAlignment="Left" Margin="0,10,0,0"
                       TextWrapping="Wrap"
                       Visibility="Collapsed"/>
        </StackPanel>
    </Border>
</Window>
